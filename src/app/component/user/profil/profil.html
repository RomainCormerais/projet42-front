<div class="container my-5">

  @if (utilisateur) {
    <!-- Header -->
    <div class="d-flex justify-content-between align-items-center mb-4">
      <div>
        <h1 class="h3 mb-0">
          <i class="fa-solid fa-utilisateur-circle me-2"></i>
          Mon profil
        </h1>
        <p class="mb-0 text-muted">
          <small>
            <i class="fa-solid fa-envelope"></i>
            {{ utilisateur.adresseMail }}
          </small>
        </p>
      </div>

      <div>
        <a routerLink="/jeux" class="btn btn-outline-secondary">
          <i class="fa-solid fa-arrow-left me-1"></i>
          Retour aux jeux
        </a>
      </div>
    </div>

    <!-- Messages -->
    @if (successMessage) {
      <div class="alert alert-success alert-dismissible fade show">
        <i class="fa-solid fa-check-circle me-2"></i>
        {{ successMessage }}
        <button type="button" class="btn-close" (click)="successMessage = ''"></button>
      </div>
    }

    @if (errorMessage) {
      <div class="alert alert-danger alert-dismissible fade show">
        <i class="fa-solid fa-exclamation-circle me-2"></i>
        {{ errorMessage }}
        <button type="button" class="btn-close" (click)="errorMessage = ''"></button>
      </div>
    }

    <div class="row">

      <!-- Colonne gauche -->
      <div class="col-lg-8">

        <!-- Modifier informations -->
        <div class="card shadow-sm mb-4">
          <div class="card-header">
            <strong>Modifier mes informations</strong>
          </div>

          <div class="card-body">

            <form [formGroup]="profilForm" (ngSubmit)="updateProfil()">

              <div class="mb-3">
                <label class="form-label">Nom d'utilisateur</label>
                <input class="form-control" formControlName="nomUtilisateur" maxlength="20">
                @if (profilForm.get('nomUtilisateur')?.invalid && profilForm.get('nomUtilisateur')?.touched) {
                  <div class="form-text text-danger">Le nom d’utilisateur est obligatoire.</div>
                }
              </div>

              <div class="mb-3">
                <label class="form-label">Adresse e-mail</label>
                <input type="adresseMail" class="form-control" formControlName="adresseMail" maxlength="50">
                @if (profilForm.get('adresseMail')?.invalid && profilForm.get('adresseMail')?.touched) {
                  <div class="form-text text-danger">Adresse adresseMail invalide.</div>
                }
              </div>

              <div class="mb-3">
                <label class="form-label">Adresse postale</label>
                <textarea class="form-control" rows="3" formControlName="address" maxlength="200"></textarea>
                <div class="form-text">Optionnel – 200 caractères max</div>
              </div>

              <div class="d-flex justify-content-end gap-2">
                <button type="button" routerLink="/jeux" class="btn btn-outline-secondary">
                  Annuler
                </button>

                <button type="submit" class="btn btn-primary" [disabled]="profilForm.invalid">
                  <i class="fa-solid fa-check me-1"></i> Enregistrer
                </button>
              </div>
            </form>

          </div>
        </div>

        <!-- Modifier mot de passe -->
        <div class="card shadow-sm mb-4">
          <div class="card-header">
            <strong>Modifier mon mot de passe</strong>
          </div>

          <div class="card-body">

            <form [formGroup]="motDePasseForm" (ngSubmit)="changeMotDePasse()">

              <div class="mb-3">
                <label class="form-label">Mot de passe actuel</label>
                <input type="MotDePasse" class="form-control" formControlName="currentMotDePasse">
              </div>

              <div class="mb-3">
                <label class="form-label">Nouveau mot de passe</label>
                <input type="MotDePasse" class="form-control" formControlName="newMotDePasse" maxlength="20">
                <div class="form-text">Max 20 caractères</div>
              </div>

              <div class="mb-3">
                <label class="form-label">Confirmation</label>
                <input type="MotDePasse" class="form-control" formControlName="confirmMotDePasse">
              </div>

              <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-warning" [disabled]="motDePasseForm.invalid">
                  <i class="fa-solid fa-key me-1"></i>
                  Changer le mot de passe
                </button>
              </div>

            </form>

          </div>
        </div>

      </div>

      <!-- Colonne droite -->
      <div class="col-lg-4">

        <div class="card shadow-sm border-danger mb-4">
          <div class="card-header bg-danger text-white">
            <strong>Zone dangereuse</strong>
          </div>

          <div class="card-body">
            <p class="text-muted small">
              La suppression est définitive et irréversible.
            </p>

            <button class="btn btn-danger w-100" (click)="removeProfil()">
              <i class="fa-solid fa-trash me-1"></i>
              Supprimer mon compte
            </button>
          </div>
        </div>

      </div>

    </div>
  }

</div>
